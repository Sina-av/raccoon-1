<!DOCTYPE html><head><meta charset="UTF-8"><title>RayTracingViewFactor | RACCOON</title><link rel="icon" type="image/x-icon" href="../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../install/index.html">Install</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../modules/index.html">Modules</a></li><li><a href="../../syntax/index.html">Syntax</a></li><li><a href="../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="071ac3e4-97e1-4443-ae7c-1dbb07ac2e5f"><i class="material-icons">menu</i></a><ul class="sidenav" id="071ac3e4-97e1-4443-ae7c-1dbb07ac2e5f"><li><a href="../../install/index.html">Install</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../modules/index.html">Modules</a></li><li><a href="../../syntax/index.html">Syntax</a></li><li><a href="../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">userobjects</span><a href="#" class="breadcrumb">RayTracingViewFactor</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="e813a8ff-4c2e-4b25-b632-1dbd1b4efa02" data-section-level="1" data-section-text="RayTracingViewFactor"><h1 id="raytracingviewfactor">RayTracingViewFactor</h1><p>Computes view factors for arbitrary geometries using raytracing.</p><section class="scrollspy" id="c4c1cc8d-261f-4c4a-82eb-e2d4e1cc7fd3" data-section-level="2" data-section-text="Description"><h2 id="description">Description</h2><p><code>RayTracingViewFactor</code> uses the ray tracing module to compute view factors for general cavities. <code>RayTracingViewFactor</code> does not require the faces of the cavity to be planar and it allows obstruction. Obstruction refers to the situation of boundary <code>a</code>&#x27;s line of sight to boundary <code>b</code> being obstructed by boundary <code>c</code>, where <code>a</code>, <code>b</code>, and <code>c</code> are boundaries participating in the radiative heat exchange. <code>RayTracingViewFactor</code> follows the general concept of radiative heat transfer geometries in MOOSE. A set of boundaries is in radiative heat transfer through a cavity filled with a transparent medium; the boundaries completely enclose the cavity so energy cannot leave the cavity by radiation.</p><p>For MOOSE&#x27;s raytracing to work, the cavity <strong>must</strong> be meshed. The view factors are computed by essentially computing the integrals in <a href="UnobstructedPlanarViewFactor.html">UnobstructedPlanarViewFactor</a>. The difference from <a href="UnobstructedPlanarViewFactor.html">UnobstructedPlanarViewFactor</a> is that the raytracer follows the ray drawn from starting to ending quadrature points and determines if the ray collides with any of the boundaries participating in the radiative heat transfer before it reaches the ending quadrature point. The view factor integrals are only incremented by the contribution associated with the starting/ending quadrature point if no collision with any boundary occurred.</p><p>The <code>RayTracingViewFactor</code> requires a <a href="ViewFactorRayStudy.html">ViewFactorRayStudy</a> for computing the view factors. The user should read the corresponding documentation.</p></section><section class="scrollspy" id="e5a6f735-8b4d-4c52-8249-e668166bfff4" data-section-level="2" data-section-text="Important Convention on Boundaries and Normals"><h2 id="important-convention-on-boundaries-and-normals">Important Convention on Boundaries and Normals</h2><p>Boundaries (or synonymously sidesets) are a collection of element faces. An element face in MOOSE is identified by the element id and a <em>local</em> face id. As a consequence, a face belongs to a particular element because it&#x27;s simply one of the element&#x27;s faces. For element faces on the domain boundary it is clear which element they belong to because there is no other element across the face. However, for internal faces the question which of the two neighboring elements an element face belongs to is important. An example helps to clarify. Let&#x27;s assume that element <code>e1</code> and <code>e2</code> are neighbors and that they are adjacent across an element face that have the local indices <code>s1</code> and <code>s2</code> in elements <code>e1</code> and <code>e2</code>, respectively. Element face <code>(e1, s1)</code> belongs to element <code>e1</code>, while element face <code>(e2, s2)</code> belongs to element <code>e2</code>. This is important when applying boundary conditions on boundaries that are not domain boundaries. Let&#x27;s say element <code>e1</code> belongs to block <code>b1</code> and element <code>e2</code> belongs to block <code>b2</code> and we want to apply boundary conditions for the heat equation solved on block <code>b1</code>. In this case, the boundary that we apply boundary conditions for the heat equation must be composed of element faces belonging to <code>b1</code>. Going back to our two neighboring example elements, the face <code>(e1,s1)</code> must be added to the boundary because it belongs to element <code>e1</code> which belongs to block <code>b1</code> which defines the temperature. If the user tries to impose the boundary condition on element face <code>(e2,s1)</code> MOOSE will segfault. This distinction between internal and external boundaries is important to understand how to define boundaries around radiation cavities.  </p><p>Boundaries enclosing a cavity are either external or internal boundaries. External boundaries do not have a neighbor on the other side of the face, while internal boundaries have valid elements on both sides of it. For external boundaries, the sideset must belong to one of the cavity blocks simply because there are no elements on the other side of the sideset.</p><p>However, for internal sidesets the cavity boundary <strong>must</strong> belong to the element right outside of the cavity. If element face <code>(e1, s1)</code> is just outside of the cavity and <code>(e2, s2)</code> is immediately on the other side inside of the cavity, then <code>(e1, s1)</code> should be used to construct the sideset. The reason is that internal sidesets will usually solve coupled heat conduction problems on the block just outside the cavity and boundary conditions for the temperature defined on this block must be imposed on the heat conduction/cavity interface.</p><p>The <a href="../meshgenerators/SideSetsBetweenSubdomainsGenerator.html">SideSetsBetweenSubdomainsGenerator</a> mesh generator can be used for setting up cavity boundaries. In this mesh generator, the sidesets will belong to the &quot;primary&quot; side. Returning to the example, if <a href="#aabd6889-f376-4148-86d6-6f32382a9f51" class="moose-modal-link modal-trigger">&quot;primary_block&quot;</a> is <code>b1</code> and <a href="#ad29b323-168e-4cff-a1db-28648bebfa89" class="moose-modal-link modal-trigger">&quot;paired_block&quot;</a> is <code>b2</code>, then <code>(e1,s1)</code> will be the element faces used in the new sideset. Specifically, the <a href="#c67775df-9368-4964-8af2-b17e65e83dde" class="moose-modal-link modal-trigger">&quot;primary_block&quot;</a> are the blocks around the cavity, while <a href="#058b9ed1-729c-4da6-b181-6ec9e123cfed" class="moose-modal-link modal-trigger">&quot;paired_block&quot;</a> are the blocks inside the cavity.</p></section><section class="scrollspy" id="91a47f0b-81a2-42e4-8da7-4bdbe2eabca7" data-section-level="2" data-section-text="Example Input syntax"><h2 id="example-input-syntax">Example Input syntax</h2><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[Mesh]
   [cartesian]
     type = CartesianMeshGenerator
     dim = 3
     dx = &#x27;0.55 0.9 0.55&#x27;
     dy = &#x27;0.55 0.9 0.55&#x27;
     dz = &#x27;0.75 0.0001 0.25&#x27;
     subdomain_id = &#x27;0 0 0
                     0 0 0
                     0 0 0
                     0 0 0
                     0 1 0
                     0 0 0
                     0 0 0
                     0 0 0
                     0 0 0&#x27;
   []

   [side_set_around_obstruction]
     type = SideSetsBetweenSubdomainsGenerator
     input = cartesian
     primary_block = 1
     paired_block = 0
     new_boundary = &#x27;obstacle&#x27;
   []
[]

[UserObjects]
  [view_factor_study]
    type = ViewFactorRayStudy
    execute_on = initial
    boundary = &#x27;left right top bottom front back obstacle&#x27;
    face_order = FOURTH
    polar_quad_order = 12
    azimuthal_quad_order = 4
    warn_subdomain_hmax = false
  []

  [view_factor]
    type = RayTracingViewFactor
    boundary = &#x27;left right top bottom front back obstacle&#x27;
    execute_on = INITIAL
    ray_study_name = view_factor_study
  []
[]

[RayBCs/viewfactor]
  type = ViewFactorRayBC
  boundary = &#x27;left right top bottom front back obstacle&#x27;
[]

# Reference solution for front -&gt; back view factor
# is 0.282833. This result is derived from analytical
# view factors from:
# front -&gt; orthogonal sides around front [left right top bottom]
# front -&gt; obstacle
# front -&gt; everywhere must be sum to 1
#
[Postprocessors]
  [front_back]
    type = ViewFactorPP
    from_boundary = front
    to_boundary = back
    view_factor_object_name = view_factor
  []
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]

[Outputs]
  csv = true
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#9d85a9ad-b41d-49dd-801f-9204a889c0bf">(moose/modules/heat_conduction/test/tests/view_factors/view_factor_obstructed.i)</a></section><section class="scrollspy" id="36526fea-d284-4155-9185-a6e35a922fbe" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="d0cfaf5b-c2ff-48ac-aa9f-eadb045543f9" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">boundary</span><span class="moose-parameter-header-description">The list of boundary IDs from the mesh where this boundary condition applies</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;BoundaryName&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The list of boundary IDs from the mesh where this boundary condition applies</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">ray_study_name</span><span class="moose-parameter-header-description">Name of the view factor ray study UO.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>UserObjectName</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Name of the view factor ray study UO.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="d410420f-d9ef-47d9-b931-dccfe1faeacf" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">execute_on</span><span class="moose-parameter-header-default">TIMESTEP_END</span><span class="moose-parameter-header-description">The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>TIMESTEP_END</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>ExecFlagEnum</p><p class="moose-parameter-description-options"><span>Options:</span>NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM</p><p class="moose-parameter-description"><span>Description:</span>The list of flag(s) indicating when this object should be executed, the available options include NONE, INITIAL, LINEAR, NONLINEAR, TIMESTEP_END, TIMESTEP_BEGIN, FINAL, CUSTOM.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">normalize_view_factor</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines if view factors are normalized to sum to one (consistent with their definition).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Determines if view factors are normalized to sum to one (consistent with their definition).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">print_view_factor_info</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Flag to print information about computed view factors.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Flag to print information about computed view factors.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">view_factor_tol</span><span class="moose-parameter-header-default">1.79769e+308</span><span class="moose-parameter-header-description">Tolerance for checking view factors. Default is to allow everything.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1.79769e+308</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Tolerance for checking view factors. Default is to allow everything.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="461e7d0e-fe02-4bec-b9f8-72a459adec5d" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">allow_duplicate_execution_on_initial</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">In the case where this UserObject is depended upon by an initial condition, allow it to be executed twice during the initial setup (once before the IC and again after mesh adaptivity (if applicable).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>In the case where this UserObject is depended upon by an initial condition, allow it to be executed twice during the initial setup (once before the IC and again after mesh adaptivity (if applicable).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section></section><div class="moose-modal modal" id="aabd6889-f376-4148-86d6-6f32382a9f51"><div class="modal-content"><h4>primary_block</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The primary set of blocks for which to draw a sideset between</p></div></div><div class="moose-modal modal" id="ad29b323-168e-4cff-a1db-28648bebfa89"><div class="modal-content"><h4>paired_block</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The paired set of blocks for which to draw a sideset between</p></div></div><div class="moose-modal modal" id="c67775df-9368-4964-8af2-b17e65e83dde"><div class="modal-content"><h4>primary_block</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The primary set of blocks for which to draw a sideset between</p></div></div><div class="moose-modal modal" id="058b9ed1-729c-4da6-b181-6ec9e123cfed"><div class="modal-content"><h4>paired_block</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The paired set of blocks for which to draw a sideset between</p></div></div><div class="moose-modal modal" id="9d85a9ad-b41d-49dd-801f-9204a889c0bf"><div class="modal-content"><h4>(moose/modules/heat_conduction/test/tests/view_factors/view_factor_obstructed.i)</h4><pre class="moose-pre"><code class="language-text">[Mesh]
   [cartesian]
     type = CartesianMeshGenerator
     dim = 3
     dx = &#x27;0.55 0.9 0.55&#x27;
     dy = &#x27;0.55 0.9 0.55&#x27;
     dz = &#x27;0.75 0.0001 0.25&#x27;
     subdomain_id = &#x27;0 0 0
                     0 0 0
                     0 0 0
                     0 0 0
                     0 1 0
                     0 0 0
                     0 0 0
                     0 0 0
                     0 0 0&#x27;
   []

   [side_set_around_obstruction]
     type = SideSetsBetweenSubdomainsGenerator
     input = cartesian
     primary_block = 1
     paired_block = 0
     new_boundary = &#x27;obstacle&#x27;
   []
[]

[UserObjects]
  [view_factor_study]
    type = ViewFactorRayStudy
    execute_on = initial
    boundary = &#x27;left right top bottom front back obstacle&#x27;
    face_order = FOURTH
    polar_quad_order = 12
    azimuthal_quad_order = 4
    warn_subdomain_hmax = false
  []

  [view_factor]
    type = RayTracingViewFactor
    boundary = &#x27;left right top bottom front back obstacle&#x27;
    execute_on = INITIAL
    ray_study_name = view_factor_study
  []
[]

[RayBCs/viewfactor]
  type = ViewFactorRayBC
  boundary = &#x27;left right top bottom front back obstacle&#x27;
[]

# Reference solution for front -&gt; back view factor
# is 0.282833. This result is derived from analytical
# view factors from:
# front -&gt; orthogonal sides around front [left right top bottom]
# front -&gt; obstacle
# front -&gt; everywhere must be sum to 1
#
[Postprocessors]
  [front_back]
    type = ViewFactorPP
    from_boundary = front
    to_boundary = back
    view_factor_object_name = view_factor
  []
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#c4c1cc8d-261f-4c4a-82eb-e2d4e1cc7fd3" class="tooltipped" data-position="left" data-tooltip="Description">Description</a></li><li><a href="#e5a6f735-8b4d-4c52-8249-e668166bfff4" class="tooltipped" data-position="left" data-tooltip="Important Convention on Boundaries and Normals">Important Convention on Boundaries and Normals</a></li><li><a href="#91a47f0b-81a2-42e4-8da7-4bdbe2eabca7" class="tooltipped" data-position="left" data-tooltip="Example Input syntax">Example Input syntax</a></li><li><a href="#36526fea-d284-4155-9185-a6e35a922fbe" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>