<!DOCTYPE html><head><meta charset="UTF-8"><title>Solving Phase Field Models | RACCOON</title><link rel="icon" type="image/x-icon" href="../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../install/index.html">Install</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../index.html">Modules</a></li><li><a href="../../syntax/index.html">Syntax</a></li><li><a href="../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="7faef5e7-9780-47b9-b248-4798f96a68df"><i class="material-icons">menu</i></a><ul class="sidenav" id="7faef5e7-9780-47b9-b248-4798f96a68df"><li><a href="../../install/index.html">Install</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../index.html">Modules</a></li><li><a href="../../syntax/index.html">Syntax</a></li><li><a href="../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">modules</a><a href="." class="breadcrumb">phase_field</a><a href="#" class="breadcrumb">Solving</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="feb43c56-4026-4cce-8338-5400d97ef9ec" data-section-level="1" data-section-text="Solving Phase Field Models"><h1 id="solving-phase-field-models">Solving Phase Field Models</h1><p>Once you have developed a phase field model using implicit time integration, you need to solve your system of nonlinear equations using MOOSE. MOOSE uses the <a href="http://www.mcs.anl.gov/petsc/documentation/">PETSc package</a> to solve the equations, therefore PETSc options that we have found to work well for phase field modeling are provided here.</p><section class="scrollspy" id="cbed3678-ec88-4cf2-b7c0-12c10378b43b" data-section-level="2" data-section-text="Solution Methods"><h2 id="solution-methods">Solution Methods</h2><p>Three solve methods are available in MOOSE, which are set in the <a href="../../syntax/Executioner/index.html">Executioner</a> block using the <strong>solve_type</strong> parameter, where the three possible options are:</p><ul class="browser-default"><li><p><code>NEWTON</code> - Direct solution of the system of equations using Newton&#x27;s method. The full and accurate Jacobian is required. Thus, the <a href="../../syntax/Preconditioning/index.html">Preconditioner</a> block must be employed for systems with multiple nonlinear variables. </p></li><li><p><code>JFNK</code> - The system is solved using Jacobian Free Newton Krylov (JFNK), so no Jacobian terms are needed. However, JFNK often does not perform well without preconditioning. </p></li><li><p><code>PJFNK</code> - The system is solved using preconditioned JFNK. The Jacobian is used to precondition the matrix, but it does not have to be fully correct and can neglect off-diagonal terms.</p></li></ul></section></section><section id="a8c7d861-90c8-4abc-95db-d8f32497ddf7" data-section-level="1" data-section-text="Preconditioning Options"><h1 id="preconditioning-options">Preconditioning Options</h1><p>When using NEWTON or PJFNK, PETSc is used to manipulate the Jacobian/preconditioner matrix. The method used for this manipulation is defined using PETSc options in the Executioner block. Determining the optimal approach can be difficult, but we have identified certain options that work well for phase field problems. They are summarized below:</p><section id="4f92387a-f97a-4fe5-9bb3-6f53c0877f3d" data-section-level="3" data-section-text="LU"><h3 id="lu">LU</h3><p>This uses LU decomposition to directly apply the inverse of the Jacobian matrix.  It is typically the most accurate approach, but is expensive and does not scale well beyond tens of processors. Parallelization requires _SUPERLU_ to be compiled into PETSc (as provided by the default installation of MOOSE). It is often a good debugging tool. Typical options in the block are</p><pre class="moose-pre"><code class="language-text">
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
</code></pre></section><section id="cc2f7aec-ffb8-480a-87f6-b4d1254a4b6d" data-section-level="3" data-section-text="ASM"><h3 id="asm">ASM</h3><p>The Additive Schwartz Method (ASM), is a domain decomposition method. It works well for most models, and is the only method that works well with the split Cahn-Hilliard equations. Increasing the <code>-pc_asm_overlap</code> improves performance but increases the computational expense. Typical options are</p><pre class="moose-pre"><code class="language-text">
  petsc_options_iname = &#x27;-pc_type -ksp_grmres_restart -sub_ksp_type -sub_pc_type -pc_asm_overlap&#x27;
  petsc_options_value = &#x27;asm      31                  preonly       lu           2&#x27;
</code></pre><section id="c5ff6db1-9d4a-47d0-9477-48dba4988da5" data-section-level="4" data-section-text="ASM / ILU"><h4 id="asm-ilu">ASM/ILU</h4><p>The incomplete factorization method (ILU) allows specifying a fill factor using <code>-pc_factor_levels</code> increasing this can improve the preconditioner. This is the default preconditioner and works well for elliptic problems such as the pahse field equations.</p></section></section><section id="160c3efe-ab39-4a90-8fd7-3493f9a86202" data-section-level="3" data-section-text="BoomerAMG"><h3 id="boomeramg">BoomerAMG</h3><p>BoomerAMG is the Hypre implementation of the Algebraic MultiGrid Method. It works well for solving the Allen-Cahn equation and the direct solution of the Cahn-Hilliard method. It has horrible performance with solving the split Cahn-Hilliard equations.  Common options are</p><pre class="moose-pre"><code class="language-text">
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type -ksp_gmres_restart -pc_hypre_boomeramg_strong_threshold&#x27;
  petsc_options_value = &#x27;hypre    boomeramg      31                 0.7&#x27;
</code></pre></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#cbed3678-ec88-4cf2-b7c0-12c10378b43b" class="tooltipped" data-position="left" data-tooltip="Solution Methods">Solution Methods</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>