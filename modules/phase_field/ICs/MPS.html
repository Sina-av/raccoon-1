<!DOCTYPE html><head><meta charset="UTF-8"><title>Use Maximal Poisson Disk Sampling MPS to generate grain centroids | RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="0f418265-b0b1-4b42-86ec-98c642319c80" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="c01570ae-ca10-48fe-a3c4-8f00cb4eb1e2" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="6fad1b23-1479-4072-af40-48b295eefe31" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="515576c4-de64-45c1-a1ba-3235d812d59a" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="682ecc1d-7761-4704-a803-ee8e30a3ffd5"><i class="material-icons">menu</i></a><ul class="sidenav" id="682ecc1d-7761-4704-a803-ee8e30a3ffd5"><li><a href="#!" class="dropdown-trigger" data-target="dc9de2b2-4ba8-4c04-8275-ab03a90d8c28" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="9da941c2-30b1-4bb7-9b39-5d11b9c29ece" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="533edd8a-9a9b-4557-99b8-db1a6e00af30" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="d8ebd344-946a-4085-bbba-97a37bf13fd6" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="0f418265-b0b1-4b42-86ec-98c642319c80"><li><a href="../../../getting_started/install.html">Install RACCOON</a></li><li><a href="../../../getting_started/update.html">Update RACCOON</a></li><li><a href="../../../getting_started/ide.html">Code development</a></li><li><a href="../../../getting_started/paraview.html">Visualization</a></li></ul><ul class="dropdown-content" id="c01570ae-ca10-48fe-a3c4-8f00cb4eb1e2"><li><a href="../../../tutorials/01_small_deformation_elasticity.html">1. Small deformation</a></li><li><a href="../../../tutorials/02_mode1_brittle_fracture.html">2. Mode-I fracture</a></li><li><a href="../../../tutorials/03_mode2_brittle_fracture.html">3. Mode-II fracture</a></li><li><a href="../../../tutorials/04_fiber_reinforced_matrix.html">4. Fiber-reinforced matrix</a></li><li><a href="../../../tutorials/05_soil_desiccation.html">5. Soil desiccation</a></li><li><a href="../../../tutorials/06_large_deformation_elasticity.html">6. Large deformation</a></li><li><a href="../../../tutorials/07_elastoplasticity.html">7. Elastoplasticity</a></li><li><a href="../../../tutorials/08_ductile_fracture.html">8. Ductile fracture</a></li><li><a href="../../../tutorials/09_three_point_bending.html">9. Three-point bending</a></li></ul><ul class="dropdown-content" id="6fad1b23-1479-4072-af40-48b295eefe31"><li><a href="../../../theory/intro.html">Introduction</a></li><li><a href="../../../theory/kinematics.html">State variables and kinematics</a></li><li><a href="../../../theory/thermodynamics.html">Thermodynamics</a></li><li><a href="../../../theory/minimization.html">The minimization problem</a></li><li><a href="../../../theory/constitutive_models.html">Constitutive Models</a></li></ul><ul class="dropdown-content" id="515576c4-de64-45c1-a1ba-3235d812d59a"><li><a href="../../index.html">Physics modules</a></li><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/raccoon.html">RACCOON syntax</a></li><li><a href="../../../syntax/tensor_mechanics.html">Tensor mechanics syntax</a></li><li><a href="../../../syntax/phase_field.html">Phase field syntax</a></li><li><a href="../../../syntax/heat_conduction.html">Heat conduction syntax</a></li></ul><ul class="dropdown-content" id="dc9de2b2-4ba8-4c04-8275-ab03a90d8c28"><li><a href="../../../getting_started/install.html">Install RACCOON</a></li><li><a href="../../../getting_started/update.html">Update RACCOON</a></li><li><a href="../../../getting_started/ide.html">Code development</a></li><li><a href="../../../getting_started/paraview.html">Visualization</a></li></ul><ul class="dropdown-content" id="9da941c2-30b1-4bb7-9b39-5d11b9c29ece"><li><a href="../../../tutorials/01_small_deformation_elasticity.html">1. Small deformation</a></li><li><a href="../../../tutorials/02_mode1_brittle_fracture.html">2. Mode-I fracture</a></li><li><a href="../../../tutorials/03_mode2_brittle_fracture.html">3. Mode-II fracture</a></li><li><a href="../../../tutorials/04_fiber_reinforced_matrix.html">4. Fiber-reinforced matrix</a></li><li><a href="../../../tutorials/05_soil_desiccation.html">5. Soil desiccation</a></li><li><a href="../../../tutorials/06_large_deformation_elasticity.html">6. Large deformation</a></li><li><a href="../../../tutorials/07_elastoplasticity.html">7. Elastoplasticity</a></li><li><a href="../../../tutorials/08_ductile_fracture.html">8. Ductile fracture</a></li><li><a href="../../../tutorials/09_three_point_bending.html">9. Three-point bending</a></li></ul><ul class="dropdown-content" id="533edd8a-9a9b-4557-99b8-db1a6e00af30"><li><a href="../../../theory/intro.html">Introduction</a></li><li><a href="../../../theory/kinematics.html">State variables and kinematics</a></li><li><a href="../../../theory/thermodynamics.html">Thermodynamics</a></li><li><a href="../../../theory/minimization.html">The minimization problem</a></li><li><a href="../../../theory/constitutive_models.html">Constitutive Models</a></li></ul><ul class="dropdown-content" id="d8ebd344-946a-4085-bbba-97a37bf13fd6"><li><a href="../../index.html">Physics modules</a></li><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/raccoon.html">RACCOON syntax</a></li><li><a href="../../../syntax/tensor_mechanics.html">Tensor mechanics syntax</a></li><li><a href="../../../syntax/phase_field.html">Phase field syntax</a></li><li><a href="../../../syntax/heat_conduction.html">Heat conduction syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="67475d51-4b9e-4844-9530-67ef5fd5752f" data-section-level="1" data-section-text="Use Maximal Poisson - Disk Sampling ( MPS ) to generate grain centroids"><h1 id="use-maximal-poisson-disk-sampling-mps-to-generate-grain-centroids">Use Maximal Poisson-Disk Sampling (MPS) to generate grain centroids</h1><p>Random close-packing (RCP) structure can be realized by a spatial sampling process known as Maximal Poisson-Disk Sampling (MPS). For the RCP structure, the average aspect ratio of each Voronoi cell is approximately one. The RCP Voronoi structure provides an equiaxed grain structure.</p><p>The MPS algorithm is described in <a href="#Ebeida_2012">Ebeida et al. (2012)</a> and it is implemented in <a href="https://github.com/trilinos/Trilinos/tree/master/packages/meshinggenie">MeshingGenie</a> package in <a href="https://trilinos.org">Trilinos</a>. MeshingGenie will generate a list of grain centroids as a text file that can then be read into the PolycrystalVoronoi initial condition.</p><section id="a5404f15-20f7-46de-9ec0-7dc1bbe7dc63" data-section-level="2" data-section-text="Build instruction for standalone version of MeshingGenie"><h2 id="build-instruction-for-standalone-version-of-meshinggenie">Build instruction for standalone version of MeshingGenie</h2><ul class="browser-default"><li><p>Download release version of <a href="https://github.com/trilinos/Trilinos/releases/tag/trilinos-release-12-12-1">Trilinos</a> (Note: please do not git clone!) </p></li><li><p>Run <code>cmake .</code> in the Trilinos/packages/meshinggenie/src/standalone/ directory </p></li><li><p>Run <code>make</code>. Executable file named MeshingGenie is located in the Trilinos/packages/meshinggenie/src/standalone/app directory</p></li></ul></section><section id="c48c3278-fd57-4e43-8612-48ab42166922" data-section-level="2" data-section-text="Run MeshingGenie to generate the centroids of grains"><h2 id="run-meshinggenie-to-generate-the-centroids-of-grains">Run MeshingGenie to generate the centroids of grains</h2><p>To run MeshingGenie, type <code>./MeshingGenie input.dat</code>. In the input file <code>input.dat</code>, the first line is &quot;p&quot;, which indicates MPS. The second line should be in the format of &quot;D R S N_bp N_bf&quot;, where D is the dimension, R the distribution radius, S the random seed, N_bp the number of boundary points and N_bf the number of boundary faces. The next N_bp lines are the x, y, and z of the boundary points in order. Each entry of the next N_bf lines describes a triangularized boundary face using the indices of the boundary points listed in an ordered direction (outwards normal using the right hand rule).</p><p>An example of 2d input file <code>2d.dat</code> is given below</p><pre class="moose-pre"><code class="language-text">
p
2 0.3 10 4 4
0 0
1 0
1 1
0 1
0 1
1 2
2 3
3 0
</code></pre><p>and 3d input file <code>3d.dat</code> is given below</p><pre class="moose-pre"><code class="language-text">
p
3 0.3 10 8 12
0 0 0
1 0 0
1 1 0
0 1 0
0 0 1
1 0 1
1 1 1
0 1 1
0 3 2
0 2 1
1 2 5
2 6 5
0 1 5
0 5 4
0 4 3
3 4 7
3 7 6
3 6 2
5 6 7
5 7 4
</code></pre><p>The output file containing centroids is stored in <code>maximal_sample.dat</code>. The first line contains the dimension, distribution radius and number of grains. An example of output file <code>maximal_sample.dat</code> is given below</p><pre class="moose-pre"><code class="language-text">
2 0.3 5
0.232307832746474 0.452347042281606
0.310283982183736 0.848418291915013
0.561253436179246 0.534434874769859
0.665658262188368 0.214715684556803
0.714381419175506 0.826132085262111
</code></pre></section><section id="78acd77c-e0e0-46ec-bf6b-d4b59f0249bb" data-section-level="2" data-section-text="Use the centroids to generate Voronoi tessellation in Phase field"><h2 id="use-the-centroids-to-generate-voronoi-tessellation-in-phase-field">Use the centroids to generate Voronoi tessellation in Phase field</h2><p>The <a href="../../../source/userobjects/PolycrystalVoronoi.html"><code>PolycrystalVoronoi</code></a> can read grain centroids from a text file and performs a Voronoi tesslation to produce a grain structure. The syntax is</p><pre class="moose-pre"><code class="language-text">
[UserObjects]
  [./voronoi]
    type = PolycrystalVoronoi
    grain_num = 5
    file_name = &#x27;grains.txt&#x27;
  [../]
[]
</code></pre><p>The <code>grains.txt</code> contains the grain centroids that can be taken from <code>maximal_sample.dat</code>. An example of text file <code>grains.txt</code> is given below</p><pre class="moose-pre"><code class="language-text">
x                 y
0.232307832746474 0.452347042281606
0.310283982183736 0.848418291915013
0.561253436179246 0.534434874769859
0.665658262188368 0.214715684556803
0.714381419175506 0.826132085262111
</code></pre></section><section id="68b820d4-6450-49aa-9b88-978390123edc" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="Ebeida_2012">Mohamed&nbsp;S. Ebeida, Scott&nbsp;A. Mitchell, Anjul Patney, Andrew&nbsp;A. Davidson, and John&nbsp;D. Owens.
A simple algorithm for maximal poisson-disk sampling in high dimensions.
<em>Comput. Graph. Forum</em>, 31(2pt4):785–794, May 2012.
URL: <a href="http://dx.doi.org/10.1111/j.1467-8659.2012.03059.x">http://dx.doi.org/10.1111/j.1467-8659.2012.03059.x</a>, <a href="https://doi.org/10.1111/j.1467-8659.2012.03059.x">doi:10.1111/j.1467-8659.2012.03059.x</a>.<a href="#a26e7c97-a3f4-4ab5-8969-3b4c4cd9375a" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="a26e7c97-a3f4-4ab5-8969-3b4c4cd9375a"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{Ebeida_2012,
    author = "Ebeida, Mohamed S. and Mitchell, Scott A. and Patney, Anjul and Davidson, Andrew A. and Owens, John D.",
    title = "A Simple Algorithm for Maximal Poisson-Disk Sampling in High Dimensions",
    journal = "Comput. Graph. Forum",
    issue_date = "May 2012",
    volume = "31",
    number = "2pt4",
    month = "May",
    year = "2012",
    issn = "0167-7055",
    pages = "785--794",
    numpages = "10",
    url = "http://dx.doi.org/10.1111/j.1467-8659.2012.03059.x",
    doi = "10.1111/j.1467-8659.2012.03059.x",
    acmid = "2322144",
    publisher = "The Eurographs Association \\&\\#38; John Wiley \\&\\#38; Sons, Ltd.",
    address = "Chichester, UK",
    keywords = "Computing Methodologies [I.3.5]: Computer Graphics\\&\\#x2014;Computational Geometry and Object Modeling"
}
</code></pre></div></div></li></ol></div><p></p></section></section></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>